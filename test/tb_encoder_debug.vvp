#! /opt/homebrew/Cellar/icarus-verilog/12.0/bin/vvp
:ivl_version "12.0 (stable)";
:ivl_delay_selection "TYPICAL";
:vpi_time_precision - 12;
:vpi_module "/opt/homebrew/Cellar/icarus-verilog/12.0/lib/ivl/system.vpi";
:vpi_module "/opt/homebrew/Cellar/icarus-verilog/12.0/lib/ivl/vhdl_sys.vpi";
:vpi_module "/opt/homebrew/Cellar/icarus-verilog/12.0/lib/ivl/vhdl_textio.vpi";
:vpi_module "/opt/homebrew/Cellar/icarus-verilog/12.0/lib/ivl/v2005_math.vpi";
:vpi_module "/opt/homebrew/Cellar/icarus-verilog/12.0/lib/ivl/va_math.vpi";
:vpi_module "/opt/homebrew/Cellar/icarus-verilog/12.0/lib/ivl/v2009.vpi";
S_0x100d027d0 .scope package, "$unit" "$unit" 2 1;
 .timescale 0 0;
S_0x100d0c410 .scope module, "tb_encoder_debug" "tb_encoder_debug" 3 4;
 .timescale -9 -12;
P_0x100d02950 .param/l "G0_OCT" 0 3 8, C4<00000111>;
P_0x100d02990 .param/l "G1_OCT" 0 3 9, C4<00000101>;
P_0x100d029d0 .param/l "K" 0 3 6, +C4<00000000000000000000000000000011>;
P_0x100d02a10 .param/l "M" 0 3 7, +C4<000000000000000000000000000000010>;
v0xc9102c3c0_0 .var "state", 1 0;
v0xc9102c460_0 .var "y0", 0 0;
v0xc9102c500_0 .var "y1", 0 0;
S_0x100d0c590 .scope task, "encode_bit" "encode_bit" 3 11, 3 11 0, S_0x100d0c410;
 .timescale -9 -12;
v0xc9102c000_0 .var "in_bit", 0 0;
v0xc9102c0a0_0 .var "sr", 2 0;
v0xc9102c140_0 .var "state_in", 1 0;
v0xc9102c1e0_0 .var "state_out", 1 0;
v0xc9102c280_0 .var "y0", 0 0;
v0xc9102c320_0 .var "y1", 0 0;
TD_tb_encoder_debug.encode_bit ;
    %vpi_call/w 3 20 "$display", "  encode_bit: in_bit=%b, state_in=%02b", v0xc9102c000_0, v0xc9102c140_0 {0 0 0};
    %load/vec4 v0xc9102c140_0;
    %load/vec4 v0xc9102c000_0;
    %concat/vec4; draw_concat_vec4
    %store/vec4 v0xc9102c0a0_0, 0, 3;
    %vpi_call/w 3 22 "$display", "  sr = %03b", v0xc9102c0a0_0 {0 0 0};
    %load/vec4 v0xc9102c0a0_0;
    %pushi/vec4 7, 0, 3;
    %and;
    %xor/r;
    %store/vec4 v0xc9102c280_0, 0, 1;
    %load/vec4 v0xc9102c0a0_0;
    %pushi/vec4 5, 0, 3;
    %and;
    %xor/r;
    %store/vec4 v0xc9102c320_0, 0, 1;
    %load/vec4 v0xc9102c0a0_0;
    %pushi/vec4 7, 0, 3;
    %and;
    %load/vec4 v0xc9102c0a0_0;
    %pushi/vec4 5, 0, 3;
    %and;
    %vpi_call/w 3 25 "$display", "  y0=%b (sr & G0 = %03b), y1=%b (sr & G1 = %03b)", v0xc9102c280_0, S<1,vec4,u3>, v0xc9102c320_0, S<0,vec4,u3> {2 0 0};
    %load/vec4 v0xc9102c0a0_0;
    %parti/s 2, 0, 2;
    %store/vec4 v0xc9102c1e0_0, 0, 2;
    %vpi_call/w 3 28 "$display", "  state_out = sr[%0d:0] = %02b", 32'sb00000000000000000000000000000001, v0xc9102c1e0_0 {0 0 0};
    %end;
    .scope S_0x100d0c410;
T_1 ;
    %vpi_call/w 3 36 "$display", "Testing encoder with explicit state management" {0 0 0};
    %vpi_call/w 3 37 "$display", "==============================================" {0 0 0};
    %pushi/vec4 0, 0, 2;
    %store/vec4 v0xc9102c3c0_0, 0, 2;
    %vpi_call/w 3 40 "$display", "\0121. Encode bit 1:" {0 0 0};
    %pushi/vec4 1, 0, 1;
    %store/vec4 v0xc9102c000_0, 0, 1;
    %load/vec4 v0xc9102c3c0_0;
    %store/vec4 v0xc9102c140_0, 0, 2;
    %fork TD_tb_encoder_debug.encode_bit, S_0x100d0c590;
    %join;
    %load/vec4 v0xc9102c1e0_0;
    %store/vec4 v0xc9102c3c0_0, 0, 2;
    %load/vec4 v0xc9102c280_0;
    %store/vec4 v0xc9102c460_0, 0, 1;
    %load/vec4 v0xc9102c320_0;
    %store/vec4 v0xc9102c500_0, 0, 1;
    %vpi_call/w 3 42 "$display", "After call: state=%02b, y0=%b, y1=%b\012", v0xc9102c3c0_0, v0xc9102c460_0, v0xc9102c500_0 {0 0 0};
    %vpi_call/w 3 44 "$display", "2. Encode bit 1 again:" {0 0 0};
    %pushi/vec4 1, 0, 1;
    %store/vec4 v0xc9102c000_0, 0, 1;
    %load/vec4 v0xc9102c3c0_0;
    %store/vec4 v0xc9102c140_0, 0, 2;
    %fork TD_tb_encoder_debug.encode_bit, S_0x100d0c590;
    %join;
    %load/vec4 v0xc9102c1e0_0;
    %store/vec4 v0xc9102c3c0_0, 0, 2;
    %load/vec4 v0xc9102c280_0;
    %store/vec4 v0xc9102c460_0, 0, 1;
    %load/vec4 v0xc9102c320_0;
    %store/vec4 v0xc9102c500_0, 0, 1;
    %vpi_call/w 3 46 "$display", "After call: state=%02b, y0=%b, y1=%b\012", v0xc9102c3c0_0, v0xc9102c460_0, v0xc9102c500_0 {0 0 0};
    %vpi_call/w 3 48 "$display", "3. Encode bit 0:" {0 0 0};
    %pushi/vec4 0, 0, 1;
    %store/vec4 v0xc9102c000_0, 0, 1;
    %load/vec4 v0xc9102c3c0_0;
    %store/vec4 v0xc9102c140_0, 0, 2;
    %fork TD_tb_encoder_debug.encode_bit, S_0x100d0c590;
    %join;
    %load/vec4 v0xc9102c1e0_0;
    %store/vec4 v0xc9102c3c0_0, 0, 2;
    %load/vec4 v0xc9102c280_0;
    %store/vec4 v0xc9102c460_0, 0, 1;
    %load/vec4 v0xc9102c320_0;
    %store/vec4 v0xc9102c500_0, 0, 1;
    %vpi_call/w 3 50 "$display", "After call: state=%02b, y0=%b, y1=%b\012", v0xc9102c3c0_0, v0xc9102c460_0, v0xc9102c500_0 {0 0 0};
    %vpi_call/w 3 52 "$finish" {0 0 0};
    %end;
    .thread T_1;
# The file index is used to find the file name in the following table.
:file_names 4;
    "N/A";
    "<interactive>";
    "-";
    "tb_encoder_debug.v";
