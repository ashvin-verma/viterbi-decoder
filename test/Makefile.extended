# Makefile for Extended Viterbi Decoder Tests (Levels 3-8)

IVERILOG = iverilog
VVP = vvp

SRC_DIR = ../src
TEST_DIR = .

SOURCES = \
	$(SRC_DIR)/ham2.v \
	$(SRC_DIR)/expected_bits.v \
	$(SRC_DIR)/branch_metric.v \
	$(SRC_DIR)/acs_core.v \
	$(SRC_DIR)/pm_bank.v \
	$(SRC_DIR)/survivor_mem.v \
	$(SRC_DIR)/traceback_v2.v \
	$(SRC_DIR)/viterbi_core.v

TB = $(TEST_DIR)/tb_viterbi_extended.v
VVP_OUT = tb_viterbi_extended.vvp
VCD_OUT = tb_viterbi_extended.vcd

VFLAGS = -g2012 -Wall

.PHONY: all compile run clean

all: run

compile: $(VVP_OUT)

$(VVP_OUT): $(TB) $(SOURCES)
	$(IVERILOG) $(VFLAGS) -o $@ $(TB) $(SOURCES)

run: $(VVP_OUT)
	$(VVP) $(VVP_OUT)

clean:
	rm -f $(VVP_OUT) $(VCD_OUT)

help:
	@echo "Extended Viterbi Decoder Test Makefile"
	@echo ""
	@echo "Targets:"
	@echo "  make         - Compile and run Levels 3-8"
	@echo "  make compile - Compile testbench only"
	@echo "  make run     - Run tests"
	@echo "  make clean   - Remove generated files"
